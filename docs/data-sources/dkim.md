---
page_title: "emaildns_dkim Data Source - emaildns"
subcategory: ""
description: |-
  Validates a DKIM (DomainKeys Identified Mail) DNS TXT record.
---

# emaildns_dkim (Data Source)

Validates a DKIM DNS TXT record per [RFC 6376](https://datatracker.ietf.org/doc/html/rfc6376). If the record is invalid, `terraform plan` fails with a specific error message.

## Example Usage

```hcl
# Basic DKIM record with RSA key
data "emaildns_dkim" "basic" {
  record = "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC..."
}

# DKIM record with Ed25519 key
data "emaildns_dkim" "ed25519" {
  record = "v=DKIM1; k=ed25519; p=11qYAYKxCrfVS/7TyWQHOg7hcvPapiMlrwIaaPcHURo="
}

# DKIM record with testing flag
data "emaildns_dkim" "testing" {
  record = "v=DKIM1; k=rsa; t=y; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC..."
}

# Revoked DKIM key (empty p= tag)
data "emaildns_dkim" "revoked" {
  record = "v=DKIM1; p="
}

# Use with Cloudflare
resource "cloudflare_record" "dkim" {
  zone_id = var.zone_id
  name    = "selector._domainkey"
  type    = "TXT"
  content = data.emaildns_dkim.basic.record
}
```

## Validation Rules

The following validations are performed:

- Record should start with `v=DKIM1` (optional per RFC, but recommended)
- Required: `p` tag (public key) - base64-encoded public key or empty for revoked keys
- Key validation:
  - RSA keys must be at least 1024 bits
  - Ed25519 keys must be exactly 32 bytes
- Optional tags are validated if present:
  - `k` (key type) - must be `rsa` or `ed25519` (defaults to `rsa`)
  - `h` (hash algorithms) - colon-separated list (e.g., `sha256:sha1`)
  - `s` (service types) - colon-separated list (e.g., `email` or `*`)
  - `t` (flags) - colon-separated list:
    - `y` - domain is testing DKIM
    - `s` - strict alignment required
  - `n` (notes) - human-readable notes

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `record` (String) The DKIM TXT record content to validate (e.g., `v=DKIM1; k=rsa; p=MIGfMA0GCS...`)

### Read-Only

- `flags` (List of String) List of flags (t tag, e.g., 'y' for testing, 's' for strict)
- `hash_algorithms` (List of String) List of acceptable hash algorithms (h tag)
- `is_revoked` (Boolean) True if the key is revoked (empty p= tag)
- `key_type` (String) The key algorithm type (rsa or ed25519)
- `notes` (String) Notes field (n tag)
- `public_key` (String) The base64-encoded public key
- `services` (List of String) List of service types (s tag)
